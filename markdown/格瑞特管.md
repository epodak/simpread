> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [bettersolutions.com](https://bettersolutions.com/vba/ribbon/document-level-notepad.htm)

> VBA 参考 - Microsoft Office 加载项和咨询。为所有 Microsoft Office 用户提供一个网站......

### 带有自定义功能区的 Excel 工作簿

仅当打开此特定工作簿时，此功能区自定义才可见。  
创建一个新工作簿并将其另存为启用宏的工作簿 (WorkbookRibbon.xlsm)。  
将工作簿的文件扩展名从 (.xlsm) 更改为 (.zip)。  
双击 zip 文件将其作为压缩文件夹打开。

![](https://bettersolutions.com/vba/ribbon/document-level-notepad-zip1.png)

### 创建自定义UI文件夹

将所有功能区 XML 放入其自己的专用文件夹中是一个好主意。  
添加使用内置图像的自定义功能区将是单个 xml 文件。  
如果您想包含自己的[自定义图像，](https://bettersolutions.com/vba/ribbon/images-editor-custom.htm)这些附加文件应放置在同一文件夹中。  
在桌面上创建一个名为“customUI”的文件夹。

### 创建自定义UI14文件

打开记事本并在此文件夹中创建一个名为“customUI14.xml”的文件。  
将下面的 xml 标签复制并粘贴到此文件中并保存文件。

```
<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui">
  <功能区startFromScratch =“true”>
    <标签>
      <tab id="CustomTab" label="我的选项卡">
        <group id="SimpleControls" label="我的组">
          <button id="Button1" imageMso="HappyFace" size="large"
            标签=“大按钮”
            onAction="ThisWorkbook.MyMacro"/>
        </组>
      </标签>
    </标签>
  </功能区>
</自定义UI>


```

将您的 customUI.xml 文件夹从桌面拖到压缩的 zip 文件夹中。

![](https://bettersolutions.com/vba/ribbon/document-level-notepad-zip2.png)

### 修改.rels文件

将 _rels 文件夹从压缩的 zip 文件夹拖到桌面。  
打开此文件夹并打开 .rels 文件。

![](https://bettersolutions.com/vba/ribbon/document-level-notepad-relsbefore.png)

**在最后的</Relationships>**标记之前添加以下行。

```
<关系 ID="customUIRelID" 类型="http://schemas.microsoft.com/office/2007/relationships/ui/extensibility"
目标=“customUI/customUI14.xml”/>


```

此行创建工作簿文件和自定义文件之间的关系。  
确保正确指定文件夹和文件名（区分大小写）。

![](https://bettersolutions.com/vba/ribbon/document-level-notepad-relsafter.png)

保存并关闭 .rels 文件。  
从压缩的 zip 文件夹中删除 _rels 文件夹。  
将 .rels 文件夹从桌面拖到压缩的 zip 文件夹中，然后关闭 zip 文件。

### 保存更改并打开

将 (.zip) 的文件扩展名更改回 (.xlsm)。  
双击 WorkbookRibbon.xlsm 文件。

![](https://bettersolutions.com/vba/ribbon/document-level-notepad-ribbon.png)

© 2024 更好解决方案有限公司。[版权所有。](https://bettersolutions.com/copyright.htm)© 2024 [Better Solutions Limited](https://bettersolutions.com/copyright.htm) [顶部](#top)[上一页](https://bettersolutions.com/vba/ribbon/document-level-customui-editor.htm "编辑")[下一页](https://bettersolutions.com/vba/ribbon/excel-application-level.htm "应用层")